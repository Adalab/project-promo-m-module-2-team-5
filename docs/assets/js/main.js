"use strict";let photo="";const data={palette:1,name:"",job:"",email:"",phone:"",linkedin:"",github:"",photo:""},fr=new FileReader,uploadBtn=document.querySelector(".js__profile-trigger"),fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview"),form=document.querySelector(".js-form"),previewNameElement=document.querySelector(".js-preview-name"),previewJobElement=document.querySelector(".js-preview-job"),previewEmailElement=document.querySelector(".js-preview-mail"),previewPhoneElement=document.querySelector(".js-preview-phone"),previewLinkedinElement=document.querySelector(".js-preview-linkedin"),previewGithubElement=document.querySelector(".js-preview-github"),resetButton=document.querySelector(".js-reset-btn"),inputEls=document.querySelectorAll(".form__fill__input");function resetPreview(){previewNameElement.innerHTML="Nombre Apellidos",previewJobElement.innerHTML="Front-end developer",previewEmailElement.href="",previewPhoneElement.href="",previewLinkedinElement.href="",previewGithubElement.href="",previewPhotoElement.style.backgroundImage="",profileImage.style.backgroundImage=""}function resetData(){for(let e=0;e<inputEls.length;e++)inputEls[e].value="";const e=document.querySelectorAll(".coloroption");for(const o of e)o.checked=!1;e[0].checked=!0;colorOrigin("1"),resetPreview()}getFromLocalStorage(),resetButton.addEventListener("click",resetData);const collapsableHeaders=document.querySelectorAll(".js-collapsable-header");for(const e of collapsableHeaders)e.addEventListener("click",handlerCollapsable);function handlerCollapsable(e){const o=e.currentTarget.parentNode,l=document.querySelectorAll(".js-collapsable-container");for(const e of l)o===e?e.classList.toggle("collapsable--close"):e.classList.add("collapsable--close")}const colorOptions=document.querySelectorAll(".coloroption");console.log(colorOptions);const colorNameEl=document.querySelector(".card__name"),colorLineEl=document.querySelector(".card__line"),colorIconBorderEl=document.querySelectorAll(".contact__icon"),colorIconEl=document.querySelectorAll(".icon");function changeColors(e){colorOrigin(e.currentTarget.value)}function colorOrigin(e){if("1"===e){colorNameEl.classList.add("card__name--color"),colorNameEl.classList.remove("color-2a","color-3a","color-4a","color-5a"),colorLineEl.classList.add("card__line--color"),colorLineEl.classList.remove("color-2b","color-3b","color-4b","color-5b");for(const e of colorIconBorderEl)e.classList.add("contact__icon--color"),e.classList.remove("color-2c","color-3c","color-4c","color-5c");for(const e of colorIconEl)e.classList.add("icon--color"),e.classList.remove("color-2a","color-3a","color-4a","color-5a")}else if("2"===e){colorNameEl.classList.add("color-2a"),colorNameEl.classList.remove("card__name--color","color-3a","color-4a","color-5a"),colorLineEl.classList.add("color-2b"),colorLineEl.classList.remove("card__line--color","color-3b","color-4b","color-5b");for(const e of colorIconBorderEl)e.classList.add("color-2c"),e.classList.remove("contact__icon--color","color-3c","color-4c","color-5c");for(const e of colorIconEl)e.classList.add("color-2a"),e.classList.remove("icon--color","color-3a","color-4a","color-5a")}else if("3"===e){colorNameEl.classList.add("color-3a"),colorNameEl.classList.remove("card__name--color","color-2a","color-4a","color-5a"),colorLineEl.classList.add("color-3b"),colorLineEl.classList.remove("card__line--color","color-2b","color-4b","color-5b");for(const e of colorIconBorderEl)e.classList.add("color-3c"),e.classList.remove("contact__icon--color","color-2c","color-4c","color-5c");for(const e of colorIconEl)e.classList.add("color-3a"),e.classList.remove("icon--color","color-2a","color-4a","color-5a")}else if("4"===e){colorNameEl.classList.add("color-4a"),colorNameEl.classList.remove("card__name--color","color-2a","color-3a","color-5a"),colorLineEl.classList.add("color-4b"),colorLineEl.classList.remove("card__line--color","color-2b","color-3b","color-5b");for(const e of colorIconBorderEl)e.classList.add("color-4c"),e.classList.remove("contact__icon--color","color-2c","color-3c","color-5c");for(const e of colorIconEl)e.classList.add("color-4a"),e.classList.remove("icon--color","color-2a","color-3a","color-5a")}else if("5"===e){colorNameEl.classList.add("color-5a"),colorNameEl.classList.remove("card__name--color","color-2a","color-3a","color-4a"),colorLineEl.classList.add("color-5b"),colorLineEl.classList.remove("card__line--color","color-2b","color-3b","color-4b");for(const e of colorIconBorderEl)e.classList.add("color-5c"),e.classList.remove("contact__icon--color","color-2c","color-3c","color-4c");for(const e of colorIconEl)e.classList.add("color-5a"),e.classList.remove("icon--color","color-2a","color-3a","color-4a")}}for(const e of colorOptions)e.addEventListener("change",changeColors);function refreshData(e){const o=e.target.name,l=e.target.value;data[o]=l}function renderPreview(e){previewNameElement.innerHTML=""===e.name?"Nombre Apellido":e.name,previewJobElement.innerHTML=""===e.job?"Front-end developer":e.job,previewEmailElement.href=""===e.email?"":e.email,previewPhoneElement.href=""===e.phone?"":e.phone,previewLinkedinElement.href=""===e.linkedin?"https://linkedin.com":"https://www.linkedin.com/in/"+e.linkedin,previewGithubElement.href=""===e.github?"https://github.com":"https://github.com/"+e.github}function handleChangeForm(e){refreshData(e),renderPreview(data),saveInLocalStorage()}function getImage(e){const o=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(o)}function writeImage(){photo=fr.result,updatePhoto()}function updatePhoto(){const e=photo;return""!==e&&(profilePreview.style.backgroundImage=`url(${e})`,profileImage.style.backgroundImage=`url(${e})`,data.photo=fr.result),data.photo}function clearPhoto(){photo="",profilePreview.style.backgroundImage="",profileImage.style.backgroundImage=""}function fakeFileClick(e){e.preventDefault(),fileField.click()}console.log(data),form.addEventListener("change",handleChangeForm),uploadBtn.addEventListener("click",fakeFileClick),fileField.addEventListener("change",getImage);const createButton=document.querySelector(".js-buttonCreateCard"),responseElement=document.querySelector(".js-response"),twitterContainer=document.querySelector(".js-hiddentw"),urlElement=document.querySelector(".js-url"),twbtnElement=document.querySelector(".js-buttontwiter");function handleClickCreate(e){e.preventDefault(),""===data.name?(responseElement.innerHTML="Recuerda completar el campo 'Nombre'.",responseElement.classList.remove("hidden")):""===data.job?(responseElement.innerHTML="<p>Recuerda completar el campo 'Puesto'.</p>",responseElement.classList.remove("hidden")):""===data.photo?(responseElement.innerHTML="<p>Recuerda subir una imagen.</p>",responseElement.classList.remove("hidden")):""===data.email?(responseElement.innerHTML="<p>Recuerda completar el campo 'Email'.</p>",responseElement.classList.remove("hidden")):pruebaemail(data.email)?(responseElement.innerHTML="<p>Revisa tu email porque no es del todo correcto.</p>",responseElement.classList.remove("hidden")):""===data.linkedin?(responseElement.innerHTML="<p>Recuerda completar el campo 'Linkedin'</p>.",responseElement.classList.remove("hidden")):""===data.github?(responseElement.innerHTML="<p>Recuerda completar el campo 'Github'.</p>",responseElement.classList.remove("hidden")):(console.log(data),console.log(data.coloroption),data.palette=data.coloroption,delete data.coloroption,console.log(data.coloroption),sendFetch(data))}function pruebaemail(e){return!/^([\da-z_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/.exec(e)}function sendFetch(e){fetch("https://awesome-profile-cards.herokuapp.com/card/",{method:"POST",headers:{Accept:"application/json","content-type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{if(!1===e.success)responseElement.innerHTML="<p>Revisa los campos sin completar</p>",responseElement.classList.remove("hidden"),console.log(JSON.stringify(e));else{let o=e.cardURL;responseElement.classList.add("hidden"),twitterContainer.classList.remove("hidden"),urlElement.innerHTML=`\n                    <p><a href="${o}">¡Aquí puedes verla!</a></p>`}console.log(e)}).catch(()=>{responseElement.innerHTML='<p class="error">El servidor parece estar fuera de servicio. Paciencia. Inténtalo más tarde.</p>',responseElement.classList.remove("hiddenIt")})}function handleTwitterShare(){twbtnElement.href="https://twitter.com/?lang=es="+shareLink}function getUserData(){return{photo:photo,palette:parseInt(document.querySelector(".js-palette:checked").value),name:document.querySelector(".js-name").value,job:document.querySelector(".js-job").value,email:document.querySelector(".js-email").value,phone:document.querySelector(".js-phone").value,linkedin:document.querySelector(".js-linkedin").value,github:document.querySelector(".js-github").value}}function saveInLocalStorage(){const e=getUserData(),o=JSON.stringify(e);localStorage.setItem("data",o)}function getFromLocalStorage(){const e=localStorage.getItem("data");if(null!==e){const o=JSON.parse(e);document.querySelector(".js-name").value=o.name,document.querySelector(".js-job").value=o.job,document.querySelector(".js-email").value=o.email,document.querySelector(".js-phone").value=o.phone,document.querySelector(".js-linkedin").value=o.linkedin,document.querySelector(".js-github").value=o.github,data.palette=parseInt(o.palette),data.name=o.name,data.job=o.job,data.email=o.email,data.phone=o.phone,data.linkedin=o.linkedin,data.github=o.github,data.photo=o.photo,renderPreview(data),updatePhoto();const l=document.querySelectorAll(".js-palette");for(const e of l)parseInt(e.value)===o.palette&&(e.checked=!0)}}console.log(data),createButton.addEventListener("click",handleClickCreate),twbtnElement.addEventListener("click",handleTwitterShare);